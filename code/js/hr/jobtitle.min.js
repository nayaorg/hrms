var job_obj=null;$(document).ready(function(){$("#btnJobClear").button().bind("click",clearJob);$("#btnJobUpdate").button().bind("click",updateJob);$("#btnJobAdd").button().bind("click",addJob);$("#btnJobPrint").button().bind("click",printJob);$("#job-tabs").tabs();$("#txtJobDesc").focus();$(window).resize(resizeJobGrid);resizeJobGrid();clearJob()});function resizeJobGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-job-entry").outerHeight()-55;$("div#sbg-job-data").css("height",a+"px")}function clearJob(){$("#txtJobId").val("Auto");$("#txtJobDesc").val("");$("#job-tabs").tabs("option","active",0);$("#txtJobDesc").focus();$("#btnJobUpdate").prop("disabled","disabled");$("#job_err_mesg").text("");$("#job_err_desc").hide();job_obj=null}function updateJob(){saveJob(C_UPDATE)}function addJob(){saveJob(C_ADD)}function saveJob(b){if(validateJob()){var c={type:b,id:$("#txtJobId").val(),desc:$("#txtJobDesc").val()};var a="request.pzx?c="+job_url+"&d="+new Date().getTime();callServer(a,"json",c,onJobResponse,job_obj)}}function printJob(){var a="report.pzx?c="+job_url+"&d="+new Date().getTime();showReport(a)}function editJob(d,c){var b={type:C_GET,id:d};var a="request.pzx?c="+job_url+"&d="+new Date().getTime();job_obj=c;callServer(a,"json",b,showJob,c)}function deleteJob(d,c){if(confirm("Confirm you want to delete job title id : "+d+"?")){var b={type:C_DELETE,id:d};var a="request.pzx?c="+job_url+"&d="+new Date().getTime();callServer(a,"json",b,onJobResponse,c)}}function showJob(a,b){if(b.status==C_OK){$("#txtJobId").val(b.data.id);$("#txtJobDesc").val(b.data.desc);$("#btnJobUpdate").prop("disabled","");$("#txtJobDesc").focus()}else{showDialog("System Message",b.mesg)}}function onJobResponse(a,b){if(b.status==C_OK){if(b.type==C_ADD){$("#sbg-job-table tr:first").after("<tr><td>"+b.data+"</td><td>"+$("#txtJobDesc").val()+"</td><td style='text-align:center'><a href='javascript:' onclick='editJob("+b.data+",this)'><img src='image/edit_16.png' title='Edit'></img></a></td><td style='text-align:center'><a href='javascript:' onclick='deleteJob("+b.data+",this)'><img src='image/delete_16.png' title='Delete'></img></a></td></tr>")}else{if(b.type==C_DELETE){$($(a).closest("tr")).remove()}else{if(b.type==C_UPDATE){$($(a).closest("tr")).children("td:eq(1)").html($("#txtJobDesc").val())}}}$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(5000);clearJob()}else{showDialog("Error",b.mesg)}}function validateJob(){$("#job_err_mesg").text("");if($("#txtJobDesc").blank()){$("#job_err_desc").show();$("#txtJobDesc").focus();$("#job_err_mesg").text("Job Title description can not be blank.");return false}else{$("#job_err_desc").hide()}return true};