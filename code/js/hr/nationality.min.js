var nat_obj=null;$(document).ready(function(){$("#btnNatClear").button().bind("click",clearNat);$("#btnNatAdd").button().bind("click",addNat);$("#btnNatUpdate").button().bind("click",updateNat);$("#btnNatPrint").button().bind("click",printNat);$("#nat-tabs").tabs();$("#txtNatDesc").focus();$(window).resize(resizeNatGrid);resizeNatGrid();clearNat()});function resizeNatGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-nat-entry").outerHeight()-55;$("div#sbg-nat-data").css("height",a+"px")}function clearNat(){$("#txtNatId").val("Auto");$("#txtNatDesc").val("");$("#txtNatRef").val("");$("#nat-tabs").tabs("option","active",0);$("#txtNatDesc").focus();$("#btnNatUpdate").prop("disabled","disabled");$("#nat_err_mesg").text("");$("#nat_err_desc").hide();$("#nat_err_ref").hide();nat_obj=null}function updateNat(){saveNat(C_UPDATE)}function addNat(){saveNat(C_ADD)}function saveNat(b){if(validateNat()){var c={type:b,id:$("#txtNatId").val(),desc:$("#txtNatDesc").val(),ref:$("#txtNatRef").val()};var a="request.pzx?c="+nat_url+"&d="+new Date().getTime();callServer(a,"json",c,onNatResponse,nat_obj)}}function printNat(){var a="report.pzx?c="+nat_url+"&d="+new Date().getTime();showReport(a)}function editNat(d,c){var b={type:C_GET,id:d};var a="request.pzx?c="+nat_url+"&d="+new Date().getTime();nat_obj=c;callServer(a,"json",b,showNat,c)}function deleteNat(d,c){if(confirm("Confirm you want to delete nationality id : "+d+"?")){var b={type:C_DELETE,id:d};var a="request.pzx?c="+nat_url+"&d="+new Date().getTime();callServer(a,"json",b,onNatResponse,c)}}function showNat(a,b){if(b.status==C_OK){$("#txtNatId").val(b.data.id);$("#txtNatDesc").val(b.data.desc);$("#txtNatRef").val(b.data.ref);$("#btnNatUpdate").prop("disabled","");$("#txtNatDesc").focus()}else{showDialog("System Message",b.mesg)}}function onNatResponse(a,b){if(b.status==C_OK){if(b.type==C_ADD){$("#sbg-nat-table tr:first").after("<tr><td>"+b.data+"</td><td>"+$("#txtNatDesc").val()+"</td><td style='text-align:center'><a href='javascript:' onclick='editNat("+b.data+",this)'><img src='image/edit_16.png' title='Edit'></img></a></td><td style='text-align:center'><a href='javascript:' onclick='deleteNat("+b.data+",this)'><img src='image/delete_16.png' title='Delete'></img></a></td></tr>")}else{if(b.type==C_DELETE){$($(a).closest("tr")).remove()}else{if(b.type==C_UPDATE){$($(a).closest("tr")).children("td:eq(1)").html($("#txtNatDesc").val())}}}$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(5000);clearNat()}else{showDialog("Error",b.mesg)}}function validateNat(){$("#nat_err_mesg").text("");if($("#txtNatDesc").blank()){$("#nat_err_desc").show();$("#txtNatDesc").focus();$("#nat_err_mesg").text("nationality description can not be blank.");return false}else{$("#nat_err_desc").hide()}if($("#txtNatRef").blank()){$("#nat_err_ref").show();$("#txtNatRef").focus();$("#nat_err_mesg").text("IRAS ref can not be blank. This ref is needed for e-submission of employee income.");return false}else{$("#nat_err_ref").hide()}return true};