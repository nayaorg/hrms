var race_obj=null;$(document).ready(function(){$("#btnRaceClear").button().bind("click",clearRace);$("#btnRaceAdd").button().bind("click",addRace);$("#btnRaceUpdate").button().bind("click",updateRace);$("#btnRacePrint").button().bind("click",printRace);$("#race-tabs").tabs();$("#txtRaceDesc").focus();$(window).resize(resizeRaceGrid);resizeRaceGrid();clearRace()});function resizeRaceGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-race-entry").outerHeight()-55;$("div#sbg-race-data").css("height",a+"px")}function clearRace(){$("#txtRaceId").val("Auto");$("#txtRaceDesc").val("");$("#race-tabs").tabs("option","active",0);$("#txtRaceDesc").focus();$("#btnRaceUpdate").prop("disabled","disabled");$("#race_err_mesg").text("");$("#race_err_desc").hide();race_obj=null}function updateRace(){saveRace(C_UPDATE)}function addRace(){saveRace(C_ADD)}function saveRace(b){if(validateRace()){var c={type:b,id:$("#txtRaceId").val(),desc:$("#txtRaceDesc").val()};var a="request.pzx?c="+race_url+"&d="+new Date().getTime();callServer(a,"json",c,onRaceResponse,race_obj)}}function printRace(){var a="report.pzx?c="+race_url+"&d="+new Date().getTime();showReport(a)}function editRace(d,c){var b={type:C_GET,id:d};var a="request.pzx?c="+race_url+"&d="+new Date().getTime();race_obj=c;callServer(a,"json",b,showRace,c)}function deleteRace(d,c){if(confirm("Confirm you want to delete race id : "+d+"?")){var b={type:C_DELETE,id:d};var a="request.pzx?c="+race_url+"&d="+new Date().getTime();callServer(a,"json",b,onRaceResponse,c)}}function showRace(a,b){if(b.status==C_OK){$("#txtRaceId").val(b.data.id);$("#txtRaceDesc").val(b.data.desc);$("#btnRaceUpdate").prop("disabled","");$("#txtRaceDesc").focus()}else{showDialog("System Message",b.mesg)}}function onRaceResponse(a,b){if(b.status==C_OK){if(b.type==C_ADD){$("#sbg-race-table tr:first").after("<tr><td>"+b.data+"</td><td>"+$("#txtRaceDesc").val()+"</td><td style='text-align:center'><a href='javascript:' onclick='editRace("+b.data+",this)'><img src='image/edit_16.png' title='Edit'></img></a></td><td style='text-align:center'><a href='javascript:' onclick='deleteRace("+b.data+",this)'><img src='image/delete_16.png' title='Delete'></img></a></td></tr>")}else{if(b.type==C_DELETE){$($(a).closest("tr")).remove()}else{if(b.type==C_UPDATE){$($(a).closest("tr")).children("td:eq(1)").html($("#txtRaceDesc").val())}}}$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(5000);clearRace()}else{showDialog("Error",b.mesg)}}function validateRace(){$("#race_err_mesg").text("");if($("#txtRaceDesc").blank()){$("#race_err_desc").show();$("#txtRaceDesc").focus();$("#race_err_mesg").text("race description can not be blank.");return false}else{$("#race_err_desc").hide()}return true};