var payentry_obj=null;var payentry_id="";$(document).ready(function(){$("input").css("marginTop",0);$("input").css("marginBottom",0);$("select").css("marginTop",0);$("select").css("marginBottom",0);$("#cobPayEntryYear").val(new Date().getFullYear());$("#cobPayEntryMonth").val(new Date().getMonth()+1);$("#btnPayEntryClear").button().bind("click",clearPayEntry);$("#btnPayEntrySave").button().bind("click",savePayEntry);$("#btnPayEntryList").button().bind("click",listPayEntry);$("#btnPayEntryTotal").button().bind("click",refreshPayEntry);$("#btnPayEntryReset").button().bind("click",resetPayEntry);$("#txtPayEntryValue").keypress(function(){numericInput(2,".",0,2)});$("#txtPayEntryQty").keypress(function(){numericInput(2,".",0,2)});for(var a=1;a<7;a++){$("#txtPayEntryIncome"+a).keypress(function(){numericInput(2,".",0,2)});$("#txtPayEntryDeduct"+a).keypress(function(){numericInput(2,".",0,2)})}$("#payentry-tabs").tabs();$("#txtPayEntryValue").focus();$(window).resize(resizePayEntryGrid);resizePayEntryGrid();clearPayEntry()});function resizePayEntryGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-payentry-entry").outerHeight()-$("#sbg-payentry-option").outerHeight()-55;$("div#sbg-payentry-data").css("height",a+"px")}function clearPayEntry(){$("#lblPayEntryIdName").text("");$("#lblPayEntryCoy").text("");$("#lblPayEntryDept").text("");$("#txtPayEntryQty").val("1");$("#txtPayEntryValue").val("");for(var a=1;a<7;a++){$("#cobPayEntryIncome"+a).val("");$("#cobPayEntryDeduct"+a).val("");$("#txtPayEntryIncome"+a).val("");$("#txtPayEntryDeduct"+a).val("")}$("#lblPayEntryBasic").text("");$("#lblPayEntryIncome").text("");$("#lblPayEntryDeduct").text("");$("#lblPayEntryNet").text("");$("#payentry-tabs").tabs("option","active",0);$("#txtPayEntryValue").focus();$("#btnPayEntrySave").prop("disabled","disabled");payentry_obj=null;payentry_id=""}function savePayEntry(){if(validatePayEntry()){var b={type:C_UPDATE,id:payentry_id,qty:$("#txtPayEntryQty").val(),value:$("#txtPayEntryValue").val(),month:$("#cobPayEntryMonth").val(),year:$("#cobPayEntryYear").val(),income:getPayEntryIncome(),deduct:getPayEntryDeduct()};var a="request.pzx?c="+payentry_url+"&d="+new Date().getTime();callServer(a,"json",b,onPayEntryResponse,payentry_obj)}}function editPayEntry(d,c){var b={type:C_GET,id:d,month:$("#cobPayEntryMonth").val(),year:$("#cobPayEntryYear").val()};var a="request.pzx?c="+payentry_url+"&d="+new Date().getTime();payentry_obj=c;callServer(a,"json",b,showPayEntry,c)}function listPayEntry(){if(validatePayEntry()){var b={type:C_LIST,coy:$("#cobPayEntryCoy").val(),dept:$("#cobPayEntryDept").val(),year:$("#cobPayEntryYear").val(),month:$("#cobPayEntryMonth").val()};var a="request.pzx?c="+payentry_url+"&d="+new Date().getTime();callServer(a,"html",b,showPayEntryList,payentry_obj)}}function getPayEntryIncome(){var c="";var a="";for(var b=1;b<7;b++){if($("#cobPayEntryIncome"+b).val()!=""&&$("#txtPayEntryIncome"+b).val()!=""){c=c+a+$("#cobPayEntryIncome"+b).val()+":"+$("#txtPayEntryIncome"+b).val();a="|"}}return c}function getPayEntryDeduct(){var c="";var a="";for(var b=1;b<7;b++){if($("#cobPayEntryDeduct"+b).val()!=""&&$("#txtPayEntryDeduct"+b).val()!=""){c=c+a+$("#cobPayEntryDeduct"+b).val()+":"+$("#txtPayEntryDeduct"+b).val();a="|"}}return c}function setPayEntryIncome(b){if(b==undefined||b==null||b==""){return}var e=b.split("|");var d="";var a=1;for(var c=0;c<e.length;c++){if(e[c]!=""){d=e[c].split(":");$("#cobPayEntryIncome"+a).val(d[0]);$("#txtPayEntryIncome"+a).val(d[1]);a++}}}function setPayEntryDeduct(b){if(b==undefined||b==null||b==""){return}var e=b.split("|");var d="";var a=1;for(var c=0;c<e.length;c++){if(e[c]!=""){d=e[c].split(":");$("#cobPayEntryDeduct"+a).val(d[0]);$("#txtPayEntryDeduct"+a).val(d[1]);a++}}}function showPayEntry(a,b){if(b.status==C_OK){clearPayEntry();payentry_id=b.data.id;$("#lblPayEntryIdName").text(b.data.id+" - "+b.data.name);$("#lblPayEntryCoy").text(b.data.coy);$("#lblPayEntryDept").text(b.data.dept);$("#txtPayEntryQty").val(b.data.qty);$("#txtPayEntryValue").val(b.data.value);if(b.data.adds!=""){setPayEntryIncome(b.data.income)}if(b.data.deducts!=""){setPayEntryDeduct(b.data.deduct)}$("#txtPayEntryQty").focus();$("#btnPayEntrySave").prop("disabled","");refreshPayEntry()}else{showDialog("System Message",b.mesg)}}function showPayEntryList(b,c){var a='<tr><td style="width:50px;height:1px"></td><td style="width:150px"></td><td style="width:200px"></td><td style="width:150px"></td><td style="width:80px"></td><td style="width:80px"></td><td style="width:80px"></td><td style="width:80px"></td><td style="width:20px"></td></tr>';$("#sbg-payentry-table").html(a+c);$("#cobPayEntryMonth").prop("disabled","disabled");$("#cobPayEntryYear").prop("disabled","disabled")}function onPayEntryResponse(a,b){if(b.status==C_OK){$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(5000);clearPayEntry()}else{showDialog("Error",b.mesg)}}function validatePayEntry(){$("#payentry_err_mesg").text("");return true}function refreshPayEntry(){var g=1;var f=0;var a=0;var e=0;var d=0;var c=0;if($("#txtPayEntryQty").val()==""){g=1}else{g=parseFloat($("#txtPayEntryQty").val().replace(",",""))}if($("#txtPayEntryValue").val()==""){f=0}else{f=parseFloat($("#txtPayEntryValue").val().replace(",",""))}a=g*f;for(var b=1;b<7;b++){if($("#cobPayEntryIncome"+b).val()!=""&&$("#txtPayEntryIncome"+b).val!=""){f=$("#txtPayEntryIncome"+b).val().replace(",","");e=e+parseFloat(f)}if($("#cobPayEntryDeduct"+b).val()!=""&&$("#txtPayEntryDeduct"+b).val()!=""){f=$("#txtPayEntryDeduct"+b).val().replace(",","");d=d+parseFloat(f)}}d=d*-1;c=a+e+d;$("#lblPayEntryNet").text(FormatCurrency(c));$("#lblPayEntryBasic").text(FormatCurrency(a));$("#lblPayEntryIncome").text(FormatCurrency(e));$("#lblPayEntryDeduct").text(FormatCurrency(d))}function resetPayEntry(){$("#cobPayEntryMonth").prop("disabled","");$("#cobPayEntryYear").prop("disabled","");$("#sbg-payentry-table").html("")};