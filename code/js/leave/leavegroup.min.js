var leavegroup_obj=null;$(document).ready(function(){$("input").css("marginTop",0);$("input").css("marginBottom",0);$("select").css("marginTop",0);$("select").css("marginBottom",0);$("#btnLeaveGroupClear").button().bind("click",clearLeaveGroup);$("#btnLeaveGroupUpdate").button().bind("click",updateLeaveGroup);$("#btnLeaveGroupAdd").button().bind("click",addLeaveGroup);$("#btnLeaveGroupPrint").button().bind("click",printLeaveGroup);for(var a=1;a<11;a++){$("#txtLeaveGroupSickLen"+a).keypress(function(){numericInput(2,".",0,2)});$("#txtLeaveGroupSickDay"+a).keypress(function(){numericInput(0,"",0,0)});$("#txtLeaveGroupAnnualLen"+a).keypress(function(){numericInput(2,".",0,2)});$("#txtLeaveGroupAnnualDay"+a).keypress(function(){numericInput(0,"",0,0)})}$("#leavegroup-tabs").tabs();$("#txtLeaveGroupDesc").focus();clearLeaveGroup();$(window).resize(resizeLeaveGroupGrid);resizeLeaveGroupGrid()});function resizeLeaveGroupGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-leavegroup-entry").outerHeight()-55;$("div#sbg-leavegroup-data").css("height",a+"px")}function clearLeaveGroup(){$("#txtLeaveGroupId").val("Auto");$("#txtLeaveGroupDesc").val("");$("#txtLeaveGroupRef").val("");$("#cobLeaveGroupSick").val("");$("#cobLeaveGroupAnnual").val("");for(var a=1;a<7;a++){$("cobLeaveGroupOther"+a).val("")}for(var a=1;a<11;a++){$("#txtLeaveGroupSickLen"+a).val("");$("#txtLeaveGroupSickDay"+a).val("");$("#txtLeaveGroupAnnualLen"+a).val("");$("#txtLeaveGroupAnnualDay"+a).val("")}$("#leaveGroup-tabs").tabs("option","active",0);$("#txtLeaveGroupDesc").focus();$("#btnLeaveGroupUpdate").prop("disabled","disabled");$("#leavegroup_err_mesg").text("");$("#leavegroup_err_desc").hide();leavegroup_obj=null}function updateLeaveGroup(){saveLeaveGroup(C_UPDATE)}function addLeaveGroup(){saveLeaveGroup(C_ADD)}function saveLeaveGroup(b){if(validateLeaveGroup()){var c={type:b,id:$("#txtLeaveGroupId").val(),desc:$("#txtLeaveGroupDesc").val(),ref:$("#txtLeaveGroupRef").val(),grptype:"0",options:getLeaveGroupOpts()};var a="request.pzx?c="+leavegroup_url+"&d="+new Date().getTime();callServer(a,"json",c,onLeaveGroupResponse,leavegroup_obj)}}function printLeaveGroup(){var a="report.pzx?c="+leavegroup_url+"&d="+new Date().getTime();showReport(a)}function editLeaveGroup(d,c){var b={type:C_GET,id:d};var a="request.pzx?c="+leavegroup_url+"&d="+new Date().getTime();leavegroup_obj=c;callServer(a,"json",b,showLeaveGroup,c)}function deleteLeaveGroup(d,c){if(confirm("Confirm you want to delete leave group id : "+d+"?")){var b={type:C_DELETE,id:d};var a="request.pzx?c="+leavegroup_url+"&d="+new Date().getTime();callServer(a,"json",b,onLeaveGroupResponse,c)}}function showLeaveGroup(a,b){if(b.status==C_OK){$("#txtLeaveGroupId").val(b.data.id);$("#txtLeaveGroupDesc").val(b.data.desc);$("#txtLeaveGroupRef").val(b.data.ref);if(b.data.options!=""){setLeaveGroupOpts(b.data.options)}$("#txtLeaveGroupDesc").focus();$("#btnLeaveGroupUpdate").prop("disabled","")}else{showDialog("System Message",b.mesg)}}function onLeaveGroupResponse(a,b){if(b.status==C_OK){if(b.type==C_ADD){$("#sbg-leavegroup-table tr:first").after("<tr><td>"+b.data+"</td><td>"+$("#txtLeaveGroupDesc").val()+"</td><td>"+$("#txtLeaveGroupRef").val()+"</td><td style='text-align:center'><a href='javascript:' onclick='editLeaveGroup("+b.data+",this)'><img src='image/edit_16.png' title='Edit'></img></a></td><td style='text-align:center'><a href='javascript:' onclick='deleteLeaveGroup("+b.data+",this)'><img src='image/delete_16.png' title='Delete'></img></a></td></tr>")}else{if(b.type==C_DELETE){$($(a).closest("tr")).remove()}else{if(b.type==C_UPDATE){$($(a).closest("tr")).children("td:eq(1)").html($("#txtLeaveGroupDesc").val());$($(a).closest("tr")).children("td:eq(2)").text($("#txtLeaveGroupRef").val())}}}$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(5000);clearLeaveGroup()}else{showDialog("Error",b.mesg)}}function validateLeaveGroup(){$("#leavegroup_err_mesg").text("");if($("#txtLeaveGroupDesc").blank()){$("#leavegroup_err_desc").show();$("#txtLeaveGroupDesc").focus();$("#leavegroup_err_mesg").text("Leave Group description can not be blank.");return false}else{$("#leavegroup_err_desc").hide()}return true}function getLeaveGroupOpts(){var c="";var a="";var d="";c=$("#cobLeaveGroupAnnual").val()+":";for(var b=1;b<11;b++){if($("#txtLeaveGroupAnnualLen"+b).val()!=""&&$("#txtLeaveGroupAnnualDay"+b).val()!=""){c=c+d+$("#txtLeaveGroupAnnualLen"+b).val()+">"+$("#txtLeaveGroupAnnualDay"+b).val();d=","}}a="|";c=c+a+$("#cobLeaveGroupSick").val()+":";d="";for(var b=1;b<11;b++){if($("#txtLeaveGroupSickLen"+b).val()!=""&&$("#txtLeaveGroupSickDay"+b).val()!=""){c=c+d+$("#txtLeaveGroupSickLen"+b).val()+">"+$("#txtLeaveGroupSickDay"+b).val();d=","}}for(var b=1;b<7;b++){if($("#cobLeaveGroupOther"+b).val()!=""){c=c+a+$("#cobLeaveGroupOther"+b).val()+":"}}return c}function setLeaveGroupOpts(e){if(e==undefined||e==null||e==""){return}var c=e.split("|");var a="";var h=1;var k="";var g="";var f=1;for(var d=0;d<c.length;d++){if(c[d]!=""){a=c[d].split(":");if(d==0){$("#cobLeaveGroupAnnual").val(a[0]);if(a[1]!=""){k=a[1].split(",");f=1;for(var b=0;b<k.length;b++){if(k[b]!=""){g=k[b].split(">");$("#txtLeaveGroupAnnualLen"+f).val(g[0]);$("#txtLeaveGroupAnnualDay"+f).val(g[1]);f++}}}}else{if(d==1){$("#cobLeaveGroupSick").val(a[0]);if(a[1]!=""){k=a[1].split(",");f=1;for(var b=0;b<k.length;b++){if(k[b]!=""){g=k[b].split(">");$("#txtLeaveGroupSickLen"+f).val(g[0]);$("#txtLeaveGroupSickDay"+f).val(g[1]);f++}}}}else{$("#cobLeaveGroupOther"+h).val(a[0]);h++}}}}};