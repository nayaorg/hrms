var project_obj=null;$("#btnProjectClear").button().bind("click",clearProject);$("#btnProjectUpdate").button().bind("click",updateProject);$("#btnProjectAdd").button().bind("click",addProject);$("#btnProjectPrint").button().bind("click",printProject);$("#project-tabs").tabs();$("#txtProjectDesc").focus();$(window).resize(resizeProjectGrid);resizeProjectGrid();clearProject();function resizeProjectGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-project-entry").outerHeight()-55;$("div#sbg-project-data").css("height",a+"px")}function clearProject(){$("#txtProjectId").val("Auto");$("#txtProjectDesc").val("");$("#txtProjectRef").val("");$("#project-tabs").tabs("option","active",0);$("#txtProjectDesc").focus();$("#btnProjectUpdate").prop("disabled","disabled");$("#project_err_mesg").text("");$("#project_err_desc").hide();project_obj=null}function updateProject(){saveProject(C_UPDATE)}function addProject(){saveProject(C_ADD)}function saveProject(b){if(validateProject()){var c={type:b,id:$("#txtProjectId").val(),desc:$("#txtProjectDesc").val(),refno:$("#txtProjectRef").val()};var a="request.pzx?c="+project_url+"&d="+new Date().getTime();callServer(a,"json",c,onProjectResponse,project_obj)}}function printProject(){var a="report.pzx?c="+project_url+"&d="+new Date().getTime();showReport(a)}function editProject(d,c){var b={type:C_GET,id:d};var a="request.pzx?c="+project_url+"&d="+new Date().getTime();project_obj=c;callServer(a,"json",b,showProject,c)}function deleteProject(d,c){if(confirm("Confirm you want to delete department id : "+d+"?")){var b={type:C_DELETE,id:d};var a="request.pzx?c="+project_url+"&d="+new Date().getTime();callServer(a,"json",b,onProjectResponse,c)}}function showProject(a,b){if(b.status==C_OK){$("#txtProjectId").val(b.data.id);$("#txtProjectDesc").val(b.data.desc);$("#txtProjectRef").val(b.data.refno);$("#btnProjectUpdate").prop("disabled","");$("#txtProjectDesc").focus()}else{showDialog("System Message",b.mesg)}}function onProjectResponse(a,b){if(b.status==C_OK){if(b.type==C_ADD){$("#sbg-project-table tr:first").after("<tr><td>"+b.data+"</td><td>"+$("#txtProjectDesc").val()+"</td><td>"+$("#txtProjectRef").val()+"</td><td style='text-align:center'><a href='javascript:' onclick='editProject("+b.data+",this)'><img src='image/edit_16.png' title='Edit'></img></a></td><td style='text-align:center'><a href='javascript:' onclick='deleteProject("+b.data+",this)'><img src='image/delete_16.png' title='Delete'></img></a></td></tr>")}else{if(b.type==C_DELETE){$($(a).closest("tr")).remove()}else{if(b.type==C_UPDATE){$($(a).closest("tr")).children("td:eq(1)").html($("#txtProjectDesc").val());$($(a).closest("tr")).children("td:eq(2)").text($("#txtProjectRef").val())}}}$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(10000);clearProject()}else{showDialog("Error",b.mesg)}}function validateProject(){$("#project_err_mesg").text("");if($("#txtProjectDesc").blank()){$("#project_err_desc").show();$("#txtProjectDesc").focus();$("#project_err_mesg").text("Project description can not be blank.");return false}else{$("#project_err_desc").hide()}return true};