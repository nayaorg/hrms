var staff_periodic_attendance_sort=new Array();$(document).ready(function(){var a={dateFormat:"dd/mm/yy",showOn:"button",buttonImage:"image/calendar.gif",buttonImageOnly:true};$("#txtDateReportBegin").datepicker(a);var c={dateFormat:"dd/mm/yy",appendText:"  dd/mm/yyyy",showOn:"button",buttonImage:"image/calendar.gif",buttonImageOnly:true};var b;for(b=0;b<document.getElementById("sbg-staff-periodic-attendance-table").rows[0].cells.length;b++){staff_periodic_attendance_sort[b]=1}$("#txtDateReportEnd").datepicker(c);$("#btnStaffPeriodicAttendanceView").button().bind("click",viewStaffPeriodicAttendance);$("#btnStaffPeriodicAttendancePrint").button().bind("click",printStaffPeriodicAttendance);$("#btnStaffPeriodicAttendanceExport").button().bind("click",exportStaffPeriodicAttendance);$("#txtDateReport").focus();$(window).resize(resizeStaffPeriodicAttendanceGrid);resizeStaffPeriodicAttendanceGrid()});function sort_table(a){var g=staff_periodic_attendance_sort[a];for(c=0;c<document.getElementById("sbg-staff-periodic-attendance-table").rows[0].cells.length;c++){staff_periodic_attendance_sort[c]=(a==c?staff_periodic_attendance_sort[c]*-1:1)}var d=document.getElementById("sbg-staff-periodic-attendance-table");var l=d.rows,h=l.length,e=new Array(),c,b,k,f;for(c=1;c<h;c++){k=l[c].cells;f=k.length;e[c-1]=new Array();for(b=0;b<f;b++){e[c-1][b]=k[b].innerHTML;k[b].innerHTML=""}}e.sort(function(j,i){return(j[a]==i[a])?0:((j[a]>i[a])?g:-1*g)});for(c=1;c<h;c++){k=l[c].cells;f=k.length;for(b=0;b<f;b++){k[b].innerHTML=e[c-1][b]}}}function resizeStaffPeriodicAttendanceGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-staff-periodic-attendance-option").outerHeight()-55;$("div#sbg-staff-periodic-attendance-data").css("height",a+"px")}function exportStaffPeriodicAttendance(){if(validateStaffPeriodicAttendance()){var d=($("input:radio[name=rdoCriteria]:checked").val()=="D")?$("#cobDepartment").val():"-1";var b=($("input:radio[name=rdoCriteria]:checked").val()=="P")?$("#txtEmpIdBegin").val():"-1";var c=($("input:radio[name=rdoCriteria]:checked").val()=="P")?$("#txtEmpIdEnd").val():"-1";var a="report.pzx?c="+staff_periodic_attendance_url+"&d="+new Date().getTime()+"&empIdBegin="+b+"&empIdEnd="+c+"&dt="+$("#txtDateReportBegin").val()+"&dtend="+$("#txtDateReportEnd").val()+"&dp="+$("#cobDepartment").val()+"&t="+C_EXPORT;showReport(a)}}function printStaffPeriodicAttendance(){var d=($("input:radio[name=rdoCriteria]:checked").val()=="D")?$("#cobDepartment").val():"-1";var b=($("input:radio[name=rdoCriteria]:checked").val()=="P")?$("#txtEmpIdBegin").val():"-1";var c=($("input:radio[name=rdoCriteria]:checked").val()=="P")?$("#txtEmpIdEnd").val():"-1";var a="report.pzx?c="+staff_periodic_attendance_url+"&d="+new Date().getTime()+"&empIdBegin="+b+"&empIdEnd="+c+"&dt="+$("#txtDateReportBegin").val()+"&dtend="+$("#txtDateReportEnd").val()+"&dp="+d+"&t="+C_REPORT;showReport(a)}function viewStaffPeriodicAttendance(){var e=($("input:radio[name=rdoCriteria]:checked").val()=="D")?$("#cobDepartment").val():"-1";var c=($("input:radio[name=rdoCriteria]:checked").val()=="P")?$("#txtEmpIdBegin").val():"-1";var d=($("input:radio[name=rdoCriteria]:checked").val()=="P")?$("#txtEmpIdEnd").val():"-1";var b={type:C_LIST,empIdBegin:c,empIdEnd:$("#txtEmpIdEnd").val(),dept:e,dateReportBegin:$("#txtDateReportBegin").val(),dateReportEnd:$("#txtDateReportEnd").val()};var a="request.pzx?c="+staff_periodic_attendance_url+"&d="+new Date().getTime();callServer(a,"html",b,showStaffPeriodicAttendance)}function validateStaffPeriodicAttendance(){if(isNaN($("#txtEmpIdBegin").val())){if(!isNaN($("#txtEmpIdEnd").val())){showDialog("Error","Invalid employee id range.");return false}}if(!isNaN($("#txtEmpIdBegin").val())){if(isNaN($("#txtEmpIdEnd").val())){showDialog("Error","Invalid employee id range.");return false}}return true}function showStaffPeriodicAttendance(b,c){var a='<tr><td style="width:30px;height:1px"></td><td style="width:100px"></td><td style="width:80px"></td><td style="width:50px"></td><td style="width:50px"></td><td style="width:50px"></td><td style="width:50px"></td><td style="width:50px"></td><td style="width:50px"></td><td style="width:30px"></td><td style="width:80px"></td></tr>';$("#sbg-staff-periodic-attendance-table").html(a+c)};