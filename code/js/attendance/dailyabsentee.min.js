var daily_absentee_sort=new Array();$(document).ready(function(){var a={dateFormat:"dd/mm/yy",showOn:"button",buttonImage:"image/calendar.gif",buttonImageOnly:true};$("#txtDateReportStart").datepicker(a);var c={dateFormat:"dd/mm/yy",appendText:"  dd/mm/yyyy",showOn:"button",buttonImage:"image/calendar.gif",buttonImageOnly:true};var b;for(b=0;b<document.getElementById("sbg-daily-absentee-table").rows[0].cells.length;b++){daily_absentee_sort[b]=1}$("#txtDateReportEnd").datepicker(c);$("#btnDailyAbsenteeView").button().bind("click",viewDailyAbsentee);$("#btnDailyAbsenteePrint").button().bind("click",printDailyAbsentee);$("#btnDailyAbsenteeExport").button().bind("click",exportDailyAbsentee);$("#txtDateReport").focus();$(window).resize(resizeDailyAbsenteeGrid);resizeDailyAbsenteeGrid()});function sort_table(a){var g=daily_attendance_sort[a];for(c=0;c<document.getElementById("sbg-daily-absentee-table").rows[0].cells.length;c++){daily_attendance_sort[c]=(a==c?daily_attendance_sort[c]*-1:1)}var d=document.getElementById("sbg-daily-absentee-table");var l=d.rows,h=l.length,e=new Array(),c,b,k,f;for(c=1;c<h;c++){k=l[c].cells;f=k.length;e[c-1]=new Array();for(b=0;b<f;b++){e[c-1][b]=k[b].innerHTML;k[b].innerHTML=""}}e.sort(function(j,i){return(j[a]==i[a])?0:((j[a]>i[a])?g:-1*g)});for(c=1;c<h;c++){k=l[c].cells;f=k.length;for(b=0;b<f;b++){k[b].innerHTML=e[c-1][b]}}}function resizeDailyAbsenteeGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-daily-absentee-option").outerHeight()-55;$("div#sbg-daily-absentee-data").css("height",a+"px")}function exportDailyAbsentee(){if(validateDailyAbsentee()){var a="report.pzx?c="+daily_absentee_url+"&d="+new Date().getTime()+"&dtend="+$("#txtDateReportEnd").val()+"&dt="+$("#txtDateReportStart").val()+"&department="+$("#cobDept").val()+"&t="+C_EXPORT;showReport(a)}}function printDailyAbsentee(){var a="report.pzx?c="+daily_absentee_url+"&d="+new Date().getTime()+"&dtend="+$("#txtDateReportEnd").val()+"&dt="+$("#txtDateReportStart").val()+"&department="+$("#cobDept").val()+"&t="+C_REPORT;showReport(a)}function viewDailyAbsentee(){var b={type:C_LIST,dept:$("#cobDept").val(),dateReportStart:$("#txtDateReportStart").val(),dateReportEnd:$("#txtDateReportEnd").val()};var a="request.pzx?c="+daily_absentee_url+"&d="+new Date().getTime();callServer(a,"html",b,showDailyAbsentee)}function validateDailyAbsentee(){return true}function showDailyAbsentee(b,c){var a='<tr><td style="width:100px;height:1px"></td><td style="width:50px"></td><td style="width:150px"></td><td style="width:200px"></td></tr>';$("#sbg-daily-absentee-table").html(a+c)};