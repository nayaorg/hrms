var activity_obj=null;$("#btnActivityClear").button().bind("click",clearActivity);$("#btnActivityUpdate").button().bind("click",updateActivity);$("#btnActivityAdd").button().bind("click",addActivity);$("#btnActivityPrint").button().bind("click",printActivity);$("#activity-tabs").tabs();$("#txtActivityDesc").focus();$(window).resize(resizeActivityGrid);resizeActivityGrid();clearActivity();function resizeActivityGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-activity-entry").outerHeight()-55;$("div#sbg-activity-data").css("height",a+"px")}function clearActivity(){$("#txtActivityId").val("Auto");$("#txtActivityDesc").val("");$("#txtActivityRef").val("");$("#activity-tabs").tabs("option","active",0);$("#txtActivityDesc").focus();$("#btnActivityUpdate").prop("disabled","disabled");$("#activity_err_mesg").text("");$("#activity_err_desc").hide();activity_obj=null}function updateActivity(){saveActivity(C_UPDATE)}function addActivity(){saveActivity(C_ADD)}function saveActivity(b){if(validateActivity()){var c={type:b,id:$("#txtActivityId").val(),desc:$("#txtActivityDesc").val(),refno:$("#txtActivityRef").val()};var a="request.pzx?c="+activity_url+"&d="+new Date().getTime();callServer(a,"json",c,onActivityResponse,activity_obj)}}function printActivity(){var a="report.pzx?c="+activity_url+"&d="+new Date().getTime();showReport(a)}function editActivity(d,c){var b={type:C_GET,id:d};var a="request.pzx?c="+activity_url+"&d="+new Date().getTime();activity_obj=c;callServer(a,"json",b,showActivity,c)}function deleteActivity(d,c){if(confirm("Confirm you want to delete department id : "+d+"?")){var b={type:C_DELETE,id:d};var a="request.pzx?c="+activity_url+"&d="+new Date().getTime();callServer(a,"json",b,onActivityResponse,c)}}function showActivity(a,b){if(b.status==C_OK){$("#txtActivityId").val(b.data.id);$("#txtActivityDesc").val(b.data.desc);$("#txtActivityRef").val(b.data.refno);$("#btnActivityUpdate").prop("disabled","");$("#txtActivityDesc").focus()}else{showDialog("System Message",b.mesg)}}function onActivityResponse(a,b){if(b.status==C_OK){if(b.type==C_ADD){$("#sbg-activity-table tr:first").after("<tr><td>"+b.data+"</td><td>"+$("#txtActivityDesc").val()+"</td><td>"+$("#txtActivityRef").val()+"</td><td style='text-align:center'><a href='javascript:' onclick='editActivity("+b.data+",this)'><img src='image/edit_16.png' title='Edit'></img></a></td><td style='text-align:center'><a href='javascript:' onclick='deleteActivity("+b.data+",this)'><img src='image/delete_16.png' title='Delete'></img></a></td></tr>")}else{if(b.type==C_DELETE){$($(a).closest("tr")).remove()}else{if(b.type==C_UPDATE){$($(a).closest("tr")).children("td:eq(1)").html($("#txtActivityDesc").val());$($(a).closest("tr")).children("td:eq(2)").text($("#txtActivityRef").val())}}}$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(10000);clearActivity()}else{showDialog("Error",b.mesg)}}function validateActivity(){$("#activity_err_mesg").text("");if($("#txtActivityDesc").blank()){$("#activity_err_desc").show();$("#txtActivityDesc").focus();$("#activity_err_mesg").text("Activity description can not be blank.");return false}else{$("#activity_err_desc").hide()}return true};