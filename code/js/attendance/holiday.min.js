var holiday_obj=null;var dteopt={dateFormat:"dd/mm/yy",appendText:"  dd/mm/yyyy",showOn:"button",buttonImage:"image/calendar.gif",buttonImageOnly:true};$("#txtHolidayDate").datepicker(dteopt);$("#btnHolidayClear").button().bind("click",clearHoliday);$("#btnHolidayUpdate").button().bind("click",updateHoliday);$("#btnHolidayAdd").button().bind("click",addHoliday);$("#btnHolidayPrint").button().bind("click",printHoliday);$("#holiday-tabs").tabs();$("#txtHolidayDate").focus();$(window).resize(resizeHolidayGrid);resizeHolidayGrid();clearHoliday();function resizeHolidayGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-holiday-entry").outerHeight()-55;$("div#sbg-holiday-data").css("height",a+"px")}function clearHoliday(){$("#txtHolidayId").val("Auto");$("#txtHolidayDate").val("");$("#txtHolidayDesc").val("");$("#holiday-tabs").tabs("option","active",0);$("#txtHolidayDate").focus();$("#btnHolidayUpdate").prop("disabled","disabled");$("#holiday_err_mesg").text("");$("#holiday_err_desc").hide();holiday_obj=null}function updateHoliday(){saveHoliday(C_UPDATE)}function addHoliday(){saveHoliday(C_ADD)}function saveHoliday(b){if(validateHoliday()){var c={type:b,id:$("#txtHolidayId").val(),date:$("#txtHolidayDate").val(),desc:$("#txtHolidayDesc").val()};var a="request.pzx?c="+holiday_url+"&d="+new Date().getTime();callServer(a,"json",c,onHolidayResponse,holiday_obj)}}function printHoliday(){var a="report.pzx?c="+holiday_url+"&d="+new Date().getTime();showReport(a)}function editHoliday(d,c){var b={type:C_GET,id:d};var a="request.pzx?c="+holiday_url+"&d="+new Date().getTime();holiday_obj=c;callServer(a,"json",b,showHoliday,c)}function deleteHoliday(d,c){if(confirm("Confirm you want to delete holiday : "+d+"?")){var b={type:C_DELETE,id:d};var a="request.pzx?c="+holiday_url+"&d="+new Date().getTime();callServer(a,"json",b,onHolidayResponse,c)}}function showHoliday(a,b){if(b.status==C_OK){$("#txtHolidayId").val(b.data.id);$("#txtHolidayDate").val(b.data.date);$("#txtHolidayDesc").val(b.data.desc);$("#btnHolidayUpdate").prop("disabled","");$("#txtHolidayDesc").focus()}else{showDialog("System Message",b.mesg)}}function onHolidayResponse(a,b){if(b.status==C_OK){if(b.type==C_ADD){$("#sbg-holiday-table tr:first").after("<tr><td>"+b.data+"</td><td>"+$("#txtHolidayDate").val()+"</td><td>"+$("#txtHolidayDesc").val()+"</td><td style='text-align:center'><a href='javascript:' onclick='editHoliday("+b.data+",this)'><img src='image/edit_16.png' title='Edit'></img></a></td><td style='text-align:center'><a href='javascript:' onclick='deleteHoliday("+b.data+",this)'><img src='image/delete_16.png' title='Delete'></img></a></td></tr>")}else{if(b.type==C_DELETE){$($(a).closest("tr")).remove()}else{if(b.type==C_UPDATE){$($(a).closest("tr")).children("td:eq(1)").html($("#txtHolidayDate").val());$($(a).closest("tr")).children("td:eq(2)").text($("#txtHolidayDesc").val())}}}$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(10000);clearHoliday()}else{showDialog("Error",b.mesg)}}function validateHoliday(){$("#holiday_err_mesg").text("");if($("#txtHolidayDate").blank()){$("#holiday_err_date").show();$("#txtHolidayDate").focus();$("#holiday_err_mesg").text("Holiday date can not be blank.");return false}else{$("#holiday_err_date").hide()}if($("#txtHolidayDesc").blank()){$("#holiday_err_desc").show();$("#txtHolidayDesc").focus();$("#holiday_err_mesg").text("Holiday description can not be blank.");return false}else{$("#holiday_err_date").hide()}return true};