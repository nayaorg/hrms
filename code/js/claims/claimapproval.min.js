var claim_approval_obj=null;$(document).ready(function(){$("#btnClaimFilter").button().bind("click",showAllClaims);$("#claim-filter-by").change(populateFilterOptions);$("#claim-tabs").tabs();$("#claim-popup-tabs").tabs();$("#claim-popup").hide();showAllClaims();$(window).resize(resizeClaimGrid);resizeClaimGrid()});function resizeClaimGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-claim-entry").outerHeight()-55;$("div#sbg-claim-data").css("height",a+"px")}function hidePopup(a){if(a==true){$("#claim-popup").animate({opacity:0,left:"+=150"},450,function(){$("#claim-popup").hide()})}else{$("#claim-popup").show();$("#claim-popup").animate({opacity:1,left:"-=150"},450,function(){})}}function updateClaimApprovedAmount(d,a){var c={type:C_UPDATE,id:d,status:"Approved",approved_amount:a};var b="request.pzx?c="+claim_approval_url+"&d="+new Date().getTime();callServer(b,"json",c,onClaimResponse,claim_approval_obj)}function viewClaim(a){hidePopup(false);showAllClaimItems(a);showAllClaimDocuments(a);$("#claim-item-title").html("Claim (ID: "+a+")")}function showClaim(a,b){if(b.status==C_OK){$("#txtClaimId").val(b.data.id);$("#txtClaimDesc").val(b.data.desc);$("#menuClaimType").val(b.data.type);$("#txtClaimDate").val(b.data.date);$("#txtClaimAmount").val(b.data.amount);$("#txtClaimBy").val(b.data.claim_by);$("#txtClaimStatus").val(b.data.status);$("#txtClaimApprovedAmount").val(b.data.approved_amount);$("#menuTravelPlan").val(b.data.travelling_plan);$("#txtClaimDesc").focus();$("#btnClaimUpdate").show();$("#btnClaimAdd").hide()}else{showDialog("System Message",b.mesg)}}function onClaimResponse(a,b){if(b.status==C_OK){if(b.type==C_UPDATE){showAllClaims()}else{if(b.type==C_LIST){$("tr#claim-rows").remove();jQuery.each(b.data,function(){var c=this.date.split(" ");$("#sbg-claim-table tr:first").after("<tr id='claim-rows'><td>"+this.id+"</td><td>"+this.desc+"</td><td>"+this.type+"</td><td>"+c[0]+"</td><td>"+this.amount+"</td><td>"+this.claim_by+"</td><td>"+this.status+"</td><td>"+this.approved_amount+"</td><td>"+this.travel_plan+"</td><td style='text-align:center'><a href='javascript:' onclick='viewClaim("+this.id+")'>View</a></td></tr>")})}}$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(5000)}else{showDialog("Error",b.mesg)}}function showAllClaims(){var b;if($("#claim-filter-by").val()!=""||$("#claim-filter-option").val()!=""){b={type:C_LIST,current_user:$("#claim-group-view-as").val(),filter_conditions:$("#claim-filter-by").val()+" = '"+$("#claim-filter-option").val()+"'"}}else{b={type:C_LIST,current_user:$("#claim-group-view-as").val()}}var a="request.pzx?c="+claim_approval_url+"&d="+new Date().getTime();callServer(a,"json",b,onClaimResponse,claim_approval_obj)}function populateFilterOptions(){if($("#claim-filter-by").val()=="CLAIM_STATUS"){$("#claim-filter-option").html("<option value='Approved'>Approved</option><option value='Pending Approval'>Pending</option>")}else{if($("#claim-filter-by").val()=="CLAIM_TYPE"){$("#claim-filter-option").html("<option value='Personal'>Personal</option><option value='Business'>Business</option>")}else{$("#claim-filter-option").html("<option value=''>-</option>")}}};