var claim_group_obj=null;$(document).ready(function(){$("#btnClaimGroupClear").button().bind("click",clearClaimGroup);$("#btnClaimGroupUpdate").button().bind("click",updateClaimGroup);$("#btnClaimGroupAdd").button().bind("click",addClaimGroup);$("#btnClaimGroupUpdate").hide();$("#claim-group-tabs").tabs();showAllClaimGroups();$(window).resize(resizeClaimGroupGrid);resizeClaimGroupGrid()});function resizeClaimGroupGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-claim-group-entry").outerHeight()-55;$("div#sbg-claim-group-data").css("height",a+"px")}function clearClaimGroup(){$("#txtClaimGroupId").val("Auto");$("#txtClaimGroupDesc").val("");$("#claim_group_err_mesg").text("");$("#claim_group_err_id").hide();$("#claim_group_err_desc").hide();$("#btnClaimGroupUpdate").hide();$("#btnClaimGroupAdd").show();clearClaimGroupHead();clearClaimGroupEmployee();claim_group_obj=null}function updateClaimGroup(){saveClaimGroup(C_UPDATE)}function addClaimGroup(){saveClaimGroup(C_ADD)}function saveClaimGroup(b){if(validateClaimGroup()){var c={type:b,id:$("#txtClaimGroupId").val(),desc:$("#txtClaimGroupDesc").val(),headLimit:getHeadLimit(),empLimit:getEmpLimit()};var a="request.pzx?c="+claim_group_url+"&d="+new Date().getTime();callServer(a,"json",c,onClaimGroupResponse,claim_group_obj)}}function editClaimGroup(d,c){var b={type:C_GET,id:d};var a="request.pzx?c="+claim_group_url+"&d="+new Date().getTime();claim_group_obj=c;callServer(a,"json",b,showClaimGroup,c)}function deleteClaimGroup(d,c){if(confirm("Confirm you want to delete claim group : id-"+d+"?")){var b={type:C_DELETE,id:d};var a="request.pzx?c="+claim_group_url+"&d="+new Date().getTime();callServer(a,"json",b,onClaimGroupResponse,c)}}function showClaimGroup(a,b){if(b.status==C_OK){$("#txtClaimGroupId").val(b.data.id);$("#txtClaimGroupDesc").val(b.data.desc);if(b.data.head!=""){showHeadLimit(b.data.head)}if(b.data.emp!=""){showEmpLimit(b.data.emp)}$("#txtClaimGroupDesc").focus();$("#btnClaimGroupUpdate").show();$("#btnClaimGroupAdd").hide();showAllClaimGroupHead()}else{showDialog("System Message",b.mesg)}}function showAllClaimGroups(){var b={type:C_LIST};var a="request.pzx?c="+claim_group_url+"&d="+new Date().getTime();callServer(a,"json",b,onClaimGroupResponse,claim_group_obj)}function onClaimGroupResponse(a,b){if(b.status==C_OK){if(b.type==C_ADD){$("#sbg-claim-group-table tr:first").after("<tr id='claim-group-rows'><td>"+b.data+"</td><td>"+$("#txtClaimGroupDesc").val()+"</td><td style='text-align:center'><a href='javascript:' onclick='editClaimGroup("+b.data+",this)'><img src='image/edit_16.png' title='Edit'></img></a></td><td style='text-align:center'><a href='javascript:' onclick='deleteClaimGroup("+b.data+",this)'><img src='image/delete_16.png' title='Delete'></img></a></td></tr>");addAllClaimGroupHead(b.data);clearClaimGroup()}else{if(b.type==C_DELETE){deleteAllClaimGroupHead(b.data);deleteAllClaimGroupEmp(b.data);$($(a).closest("tr")).remove()}else{if(b.type==C_UPDATE){$($(a).closest("tr")).children("td:eq(0)").html($("#txtClaimGroupId").val());$($(a).closest("tr")).children("td:eq(1)").html($("#txtClaimGroupDesc").val());$("#btnClaimGroupAdd").show();$("#btnClaimGroupClear").show();$("#btnClaimGroupUpdate").hide();addAllClaimGroupHead($("#txtClaimGroupId").val())}else{if(b.type==C_LIST){$("tr#claim-group-rows").remove();jQuery.each(b.data,function(){$("#sbg-claim-group-table tr:first").after("<tr id='claim-group-rows'><td>"+this.id+"</td><td>"+this.desc+"</td><td style='text-align:center'><a href='javascript:' onclick='editClaimGroup("+this.id+",this)'><img src='image/edit_16.png' title='Edit'></img></a></td><td style='text-align:center'><a href='javascript:' onclick='deleteClaimGroup("+this.id+",this)'><img src='image/delete_16.png' title='Delete'></img></a></td></tr>")})}}}}$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(5000);clearClaimGroup()}else{showDialog("Error",b.mesg)}}function validateClaimGroup(){var a=true;$("#claim_group_err_mesg").text("");if($("#txtClaimGroupDesc").blank()){$("#claim_group_err_desc").show();$("#txtClaimGroupDesc").focus();$("#claim_group_err_mesg").text($("#claim_group_err_mesg").text()+"Description can not be blank. ");a=false}else{$("#claim_group_err_desc").hide()}return a}function getHeadLimit(){var a="";var b="";var c="";var d="";$("#tblHeadLimit tr").each(function(){d=$(this).find("td").eq(0).html();c=$("#txtHeadId"+d).val();a=a+b+c;b="|"});return a}function getEmpLimit(){var a="";var c="";var b="";var d="";$("#tblLimit tr").each(function(){d=$(this).find("td").eq(0).html();b=$("#txtEmpId"+d).val();a=a+c+b;c="|"});return a};