var usrgrp_obj=null;$(document).ready(function(){$("#btnUsrGrpClear").button().bind("click",clearUserGroup);$("#btnUsrGrpUpdate").button().bind("click",updateUserGroup);$("#btnUsrGrpAdd").button().bind("click",addUserGroup);$("#btnUsrGrpPrint").button().bind("click",printUserGroup);$("#usrgrp-tabs").tabs();$("#txtUsrGrpDesc").focus();$(window).resize(resizeUsrGrpGrid);resizeUsrGrpGrid();clearUserGroup()});function resizeUsrGrpGrid(){var a=$("#sbg-center-panel").outerHeight()-$("#sbg-usrgrp-entry").outerHeight()-55;$("div#sbg-usrgrp-data").css("height",a+"px")}function clearUserGroup(){$("#txtUsrGrpId").val("Auto");$("#txtUsrGrpDesc").val("");$("#usrgrp-tabs").find(":checkbox").each(function(){$(this).prop("checked",false)});$("#usrgrp-tabs").tabs("option","active",0);$("#txtUsrGrpDesc").focus();$("#btnUsrGrpUpdate").prop("disabled","disabled");$("#usrgrp_err_desc").hide();$("#usrgrp_err_mesg").text("");usrgrp_obj=null}function updateUserGroup(){saveUserGroup(C_UPDATE)}function addUserGroup(){saveUserGroup(C_ADD)}function saveUserGroup(b){if(validateUserGroup()){var c={type:b,id:$("#txtUsrGrpId").val(),desc:$("#txtUsrGrpDesc").val(),admin:getAdmin(),hr:getHr(),payroll:getPayroll()};var a="request.pzx?c="+usrgrp_url+"&d="+new Date().getTime();callServer(a,"json",c,onUserGroupResponse,usrgrp_obj)}}function printUserGroup(){var a="report.pzx?c="+usrgrp_url+"&d="+new Date().getTime();showReport(a)}function editUserGroup(d,c){var b={type:C_GET,id:d};var a="request.pzx?c="+usrgrp_url+"&d="+new Date().getTime();usrgrp_obj=c;callServer(a,"json",b,showUserGroup,c)}function deleteUserGroup(d,c){if(confirm("Confirm you want to delete user group id : "+d+"?")){var b={type:C_DELETE,id:d};var a="request.pzx?c="+usrgrp_url+"&d="+new Date().getTime();callServer(a,"json",b,onUserGroupResponse,c)}}function showUserGroup(a,b){if(b.status==C_OK){$("#txtUsrGrpId").val(b.data.id);$("#txtUsrGrpDesc").val(b.data.desc);$("#btnUsrGrpUpdate").prop("disabled","");$("#chkAdmSet").prop("checked",b.data.admin.setting);$("#chkAdmCoy").prop("checked",b.data.admin.company);$("#chkAdmUser").prop("checked",b.data.admin.user);$("#chkAdmGroup").prop("checked",b.data.admin.group);$("#chkAdmReset").prop("checked",b.data.admin.reset);$("#chkHrEmp").prop("checked",b.data.hr.employee);$("#chkHrDept").prop("checked",b.data.hr.dept);$("#chkHrType").prop("checked",b.data.hr.type);$("#chkHrJob").prop("checked",b.data.hr.job);$("#chkHrNat").prop("checked",b.data.hr.nat);$("#chkHrRace").prop("checked",b.data.hr.race);$("#chkHrPermit").prop("checked",b.data.hr.permit);$("#chkPayBank").prop("checked",b.data.payroll.bank);$("#chkPayCpf").prop("checked",b.data.payroll.cpf);$("#chkPayType").prop("checked",b.data.payroll.type);$("#chkPayEmp").prop("checked",b.data.payroll.employee);$("#chkPayCreate").prop("checked",b.data.payroll.create);$("#chkPayEntry").prop("checked",b.data.payroll.entry);$("#chkPayList").prop("checked",b.data.payroll.paylist);$("#chkPaySlip").prop("checked",b.data.payroll.payslip);$("#chkCpfList").prop("checked",b.data.payroll.cpflist);$("#chkCpfEntry").prop("checked",b.data.payroll.cpfentry);$("#chkIncomeYear").prop("checked",b.data.payroll.incomeyear);$("#usrgrp-tabs").tabs("select",0);$("#txtUsrGrpDesc").focus()}else{showDialog("System Message",b.mesg)}}function onUserGroupResponse(a,b){if(b.status==C_OK){if(b.type==C_ADD){$("#sbg-usrgrp-table tr:first").after("<tr><td>"+b.data+"</td><td>"+$("#txtUsrGrpDesc").val()+"</td><td style='text-align:center'><a href='javascript:' onclick='editUserGroup("+b.data+",this)'><img src='image/edit_16.png' title='Edit'></img></a></td><td style='text-align:center'><a href='javascript:' onclick='deleteUserGroup("+b.data+",this)'><img src='image/delete_16.png' title='Delete'></img></a></td></tr>")}else{if(b.type==C_DELETE){$($(a).closest("tr")).remove()}else{if(b.type==C_UPDATE){$($(a).closest("tr")).children("td:eq(1)").html($("#txtUsrGrpDesc").val())}}}$("#sbg-popup-box").html(b.mesg);$("#sbg-popup-box").show();$("#sbg-popup-box").fadeOut(5000);clearUserGroup()}else{showDialog("Error",b.mesg)}}function validateUserGroup(){$("#usrgrp_err_mesg").text("");if($("#txtUsrGrpDesc").blank()){$("#usrgrp_err_desc").show();$("#txtUsrGrpDesc").focus();$("#usrgrp_err_mesg").text("User Group description can not be blank.");return false}else{$("#usrgrp_err_desc").hide()}return true}function getAdmin(){return{setting:getAccess("chkAdmSet"),company:getAccess("chkAdmCoy"),user:getAccess("chkAdmUser"),group:getAccess("chkAdmGroup"),reset:getAccess("chkAdmReset")}}function getHr(){return{employee:getAccess("chkHrEmp"),type:getAccess("chkHrType"),dept:getAccess("chkHrDept"),job:getAccess("chkHrJob"),nat:getAccess("chkHrNat"),race:getAccess("chkHrRace"),permit:getAccess("chkHrPermit")}}function getPayroll(){return{bank:getAccess("chkPayBank"),employee:getAccess("chkPayEmp"),type:getAccess("chkPayType"),cpf:getAccess("chkPayCpf"),create:getAccess("chkPayCreate"),entry:getAccess("chkPayEntry"),paylist:getAccess("chkPayList"),payslip:getAccess("chkPaySlip"),cpflist:getAccess("chkCpfList"),cpfentry:getAccess("chkCpfEntry"),incomeyear:getAccess("chkIncomeYear")}}function getAccess(a){if($("#"+a).is(":checked")){return"1"}else{return"0"}};