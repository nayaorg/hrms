$(document).ready(function(){$("input").css("marginTop",0);$("input").css("marginBottom",0);$("select").css("marginTop",0);$("select").css("marginBottom",0);$("#setting-tabs").tabs();$("#txtSettingName1").focus();$("#btnSettingUpdate").button().bind("click",updateSetting);$("#btnSettingUpload").button().bind("click",uploadSetting);$("#btnSettingRemove").button().bind("click",removeSetting);if($("#imgLogo").attr("src")==""){$("#btnSettingRemove").prop("disabled","disabled")}});function updateSetting(){saveSetting(C_UPDATE)}function saveSetting(b){if(validateSetting()){var c={type:b,name1:$("#txtSettingName1").val(),code:$("#txtSettingCode").val(),addr1:$("#txtSettingAddr1").val(),addr2:$("#txtSettingAddr2").val(),addr3:$("#txtSettingAddr3").val(),addr4:$("#txtSettingAddr4").val(),addr5:$("#txtSettingAddr5").val(),refno:$("#txtSettingRefNo").val(),telno:$("#txtSettingTelNo").val(),faxno:$("#txtSettingFaxNo").val(),failcount:"3"};var a="request.pzx?c="+setting_url+"&d="+new Date().getTime();clearSetting();callServer(a,"json",c,onSettingResponse,null)}}function clearSetting(){$("#setting_err_mesg").text("")}function onSettingResponse(a,b){if(b.status==C_OK){if(b.type==C_DELETE){$("#imgLogo").prop("src","");$("#btnSettingRemove").prop("disabled","disabled")}showDialog("System Message",b.mesg)}else{showDialog("Error",b.mesg)}}function validateSetting(){$("#setting_err_mesg").text("");if($("#txtSettingName1").blank()){$("#setting_err_name1").show();$("#txtSettingName1").focus();$("#setting_err_mesg").text("Organization name can not be blank.");return false}else{$("#setting_err_name1").hide()}if($("#txtSettingCode").blank()){$("#setting_err_code").show();$("#txtSettingCode").focus();$("#setting_err_mesg").text("Organization code can not be blank.");return false}else{$("#setting_err_code").hide()}return true}function onUploadEnd(b){$("#setting_upload").hide();$("#btnSettingUpload").prop("disabled","");var a=b.split("|");if(a[0]==C_OK){$("#imgLogo").prop("src",a[1]);$("#btnSettingRemove").prop("disabled","")}else{alert(a[1])}}function uploadSetting(){var b=$("#fileLogo").val();if(b==""){showDialog("System Message","You must select a logo image file for upload.");return}if(validImageExt(b)){$("#btnSettingUpload").prop("disabled","disabled");var a="upload.pzx?t=l&n=fileLogo&d="+new Date().getTime();$("#setting_upload").show();uploaded=false;ajaxUpload(this.form,a,onUploadEnd)}}function removeSetting(){if(confirm("Confirm you want to remove the logo?")){var b={type:C_DELETE};var a="request.pzx?c="+setting_url+"&d="+new Date().getTime();callServer(a,"json",b,onSettingResponse,null)}}function validImageExt(a){var c=new Array(".png",".jpg",".jpeg");var d=false;if(!a){return}while(a.indexOf("\\")!=-1){a=a.slice(a.indexOf("\\")+1)}var b=a.slice(a.indexOf(".")).toLowerCase();for(var e=0;e<c.length;e++){if(c[e]==b){d=true;break}}if(d){return true}else{alert("You can only upload files in .png, .jpg, .jpeg format");return false}};